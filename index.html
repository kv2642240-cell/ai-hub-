<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE AI HUB | GST Billing & Ledger</title>
    <style>
        :root { --primary: #6366f1; --bg: #0b0f1a; --card: #161b2c; --green: #10b981; --red: #ef4444; --yellow: #f59e0b; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); color: white; margin: 0; padding: 15px; display: flex; flex-direction: column; align-items: center; }
        .card { background: var(--card); padding: 20px; border-radius: 20px; border: 1px solid #2d3748; width: 100%; max-width: 450px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        input { width: 90%; padding: 12px; border-radius: 10px; border: 1px solid #2d3748; background: #1a202c; color: white; margin-bottom: 10px; outline: none; text-align: center; }
        .btn { width: 100%; padding: 12px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; color: white; margin-bottom: 5px; }
        .list-area { text-align: left; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 12px; margin-top: 10px; max-height: 150px; overflow-y: auto; }
        .item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px dashed #2d3748; font-size: 13px; }
        
        /* GST Bill Styling */
        #billModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; color: black; padding: 20px; box-sizing: border-box; overflow-y: auto; z-index: 1000; }
        .bill-header { text-align: center; border-bottom: 2px solid black; padding-bottom: 10px; }
        .bill-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .bill-table th, .bill-table td { border: 1px solid black; padding: 8px; text-align: left; }
    </style>
</head>
<body>

    <div id="homePage" class="card">
        <h1 style="color: var(--primary);">THE AI HUB</h1>
        <p style="font-size: 13px; color: #94a3b8;">Search Account to manage Udhari & Bills</p>
        <input type="text" id="userInput" placeholder="Enter Customer Name (Search)">
        <button onclick="enterDash()" class="btn" style="background: var(--primary);">üìÇ OPEN DASHBOARD / SEARCH</button>
        <div style="margin-top: 15px;">
            <a href="https://www.instagram.com/_verma_karan08" style="color: #cbd5e1; text-decoration:none; margin-right:15px;">Instagram</a>
            <a href="mailto:kv2642240@gmail.com" style="color: #cbd5e1; text-decoration:none;">Gmail</a>
        </div>
    </div>

    <div id="dashPage" style="display: none; width: 100%; max-width: 480px;">
        <div class="card">
            <h2 id="userHeading" style="margin: 0; color: var(--primary);"></h2>
            <button onclick="generateBill()" class="btn" style="background: #ffffff; color: black; margin-top:10px;">üìÑ GENERATE GST BILL</button>
        </div>

        <div class="card">
            <p style="text-align: left; font-weight: bold;">Quick Entry Panel:</p>
            <input type="number" id="amtInput" placeholder="Enter Amount (‚Çπ)">
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px;">
                <button onclick="addData('udhari')" class="btn" style="background: var(--yellow);">+ Udhari</button>
                <button onclick="addData('profit')" class="btn" style="background: var(--green);">+ Profit</button>
                <button onclick="addData('loss')" class="btn" style="background: var(--red);">+ Loss</button>
            </div>
        </div>

        <div class="card" style="text-align: left;">
            <h4 style="color: var(--yellow);">üü° UDHARI (Total: ‚Çπ<span id="uTotal">0</span>)</h4>
            <div id="udhariList" class="list-area"></div>
            <h4 style="color: var(--green);">üü¢ PROFIT LIST</h4>
            <div id="profitList" class="list-area"></div>
            <h4 style="color: var(--red);">üî¥ LOSS LIST</h4>
            <div id="lossList" class="list-area"></div>
        </div>

        <button onclick="location.reload()" class="btn" style="background: #334155; margin-bottom: 50px;">‚¨ÖÔ∏è BACK TO SEARCH</button>
    </div>

    <div id="billModal">
        <div class="bill-header">
            <h2>THE AI HUB - INVOICE</h2>
            <p>IIT Patna | Founder: Harshwardhan Singh Lodhi</p>
            <p>Email: kv2642240@gmail.com</p>
        </div>
        <p><strong>Customer Name:</strong> <span id="billCustName"></span></p>
        <p><strong>Date:</strong> <span id="billDate"></span></p>
        <table class="bill-table">
            <thead>
                <tr><th>Description</th><th>Amount (‚Çπ)</th></tr>
            </thead>
            <tbody id="billItems"></tbody>
            <tfoot>
                <tr><th>Subtotal</th><td id="subtotal"></td></tr>
                <tr><th>GST (18%)</th><td id="gst"></td></tr>
                <tr><th><strong>Grand Total</strong></th><td id="grandTotal" style="font-weight:bold;"></td></tr>
            </tfoot>
        </table>
        <div style="margin-top: 30px; text-align: center;">
            <button onclick="window.print()" style="padding: 10px 20px; background: blue; color: white; border:none; border-radius:5px;">Download / Print PDF</button>
            <button onclick="document.getElementById('billModal').style.display='none'" style="padding: 10px 20px; background: grey; color: white; border:none; border-radius:5px;">Close</button>
        </div>
    </div>

    <script>
        let currentUser = "";

        function enterDash() {
            let name = document.getElementById('userInput').value.trim().toLowerCase();
            if(!name) return alert("Please enter a name!");
            currentUser = name;
            document.getElementById('homePage').style.display = 'none';
            document.getElementById('dashPage').style.display = 'block';
            document.getElementById('userHeading').innerText = "Account: " + name.toUpperCase();
            loadData();
        }

        function addData(type) {
            let amt = document.getElementById('amtInput').value;
            if(!amt) return alert("Enter amount!");
            let key = currentUser + "_" + type;
            let db = JSON.parse(localStorage.getItem(key)) || [];
            db.push({ id: Date.now(), amt: parseFloat(amt), time: new Date().toLocaleDateString() });
            localStorage.setItem(key, JSON.stringify(db));
            document.getElementById('amtInput').value = '';
            loadData();
        }

        function loadData() {
            let totalUdhari = 0;
            ['udhari', 'profit', 'loss'].forEach(type => {
                let key = currentUser + "_" + type;
                let list = document.getElementById(type + "List");
                let db = JSON.parse(localStorage.getItem(key)) || [];
                list.innerHTML = db.length ? '' : '<p style="text-align:center;color:#4a5568;font-size:11px;">No records</p>';
                db.forEach(item => {
                    if(type === 'udhari') totalUdhari += item.amt;
                    list.innerHTML += `<div class="item"><span>üìÖ ${item.time} - ‚Çπ${item.amt}</span><button onclick="removeItem('${type}', ${item.id})" style="color:var(--red); border:none; background:none; cursor:pointer;">‚úï</button></div>`;
                });
            });
            document.getElementById('uTotal').innerText = totalUdhari;
        }

        function removeItem(type, id) {
            let key = currentUser + "_" + type;
            let db = JSON.parse(localStorage.getItem(key));
            localStorage.setItem(key, JSON.stringify(db.filter(i => i.id !== id)));
            loadData();
        }

        function generateBill() {
            let db = JSON.parse(localStorage.getItem(currentUser + "_udhari")) || [];
            if(!db.length) return alert("No udhari found to generate bill!");
            
            document.getElementById('billCustName').innerText = currentUser.toUpperCase();
            document.getElementById('billDate').innerText = new Date().toLocaleDateString();
            let itemsHtml = "";
            let subtotal = 0;
            db.forEach(item => {
                itemsHtml += `<tr><td>Transaction on ${item.time}</td><td>‚Çπ${item.amt}</td></tr>`;
                subtotal += item.amt;
            });
            let gst = subtotal * 0.18;
            document.getElementById('billItems').innerHTML = itemsHtml;
            document.getElementById('subtotal').innerText = "‚Çπ" + subtotal.toFixed(2);
            document.getElementById('gst').innerText = "‚Çπ" + gst.toFixed(2);
            document.getElementById('grandTotal').innerText = "‚Çπ" + (subtotal + gst).toFixed(2);
            document.getElementById('billModal').style.display = 'block';
        }
    </script>
</body>
</html>
