<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE AI HUB | Digital Khata Management</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #1a73e8; --success: #34a853; --danger: #ea4335; --bg: #f8fafc; }
        body { font-family: 'Poppins', sans-serif; background: var(--bg); margin: 0; padding: 15px; color: #1e293b; }
        .container { max-width: 500px; margin: auto; }
        .card { background: white; padding: 20px; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); margin-bottom: 20px; }
        input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #e2e8f0; border-radius: 10px; box-sizing: border-box; font-size: 14px; }
        button { width: 100%; padding: 14px; border: none; border-radius: 10px; font-weight: 700; cursor: pointer; transition: 0.3s; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .btn-profit { background: var(--success); color: white; }
        .btn-loss { background: var(--danger); color: white; }
        .search-input { border: 2px solid var(--primary); background: #f0f7ff; }
        .record-row { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9; }
        .insta-link { display: inline-block; margin-top: 10px; color: #d62976; font-weight: 600; text-decoration: none; font-size: 14px; }
        #login-screen { text-align: center; padding-top: 80px; }
        .dev-tag { font-size: 12px; color: #64748b; margin-top: 25px; border-top: 1px solid #e2e8f0; padding-top: 15px; line-height: 1.6; }
    </style>
</head>
<body>

<div class="container">
    <div id="login-screen" class="card">
        <h1 style="color: var(--primary); margin-bottom: 5px;">THE AI HUB</h1>
        <p style="color: #64748b;">Enter your name to access your dashboard</p>
        <input type="text" id="authName" placeholder="Enter Full Name...">
        <button style="background: var(--primary); color: white;" onclick="handleLogin()">Login to Dashboard</button>
    </div>

    <div id="main-dashboard" style="display:none;">
        <div class="card" style="background: linear-gradient(135deg, #1a73e8, #1557b0); color: white;">
            <h2 style="margin:0;">Welcome, <span id="user-display"></span>!</h2>
            <p style="font-size: 13px; opacity: 0.9;">Digital Business Overview</p>
            <div class="grid" style="margin-top: 15px;">
                <div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 10px;">
                    <small>Total Profit</small><br><b id="sumProfit" style="font-size: 18px;">$0</b>
                </div>
                <div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 10px;">
                    <small>Total Credit (Loss)</small><br><b id="sumLoss" style="font-size: 18px;">$0</b>
                </div>
            </div>
            <a href="https://www.instagram.com/h_a_r_s_h_w_a_r_d_h_a_n_19/" class="insta-link" style="color: #ffdaea;" target="_blank">ðŸ“¸ Connect on Instagram</a>
        </div>

        <div class="card">
            <h3 style="margin-top:0;">New Transaction</h3>
            <input type="text" id="customer" placeholder="Customer Name (For Search)">
            <input type="number" id="valAmount" placeholder="Amount ($ / â‚¹)">
            <div class="grid">
                <button class="btn-profit" onclick="recordEntry('profit')">+ Add Profit</button>
                <button class="btn-loss" onclick="recordEntry('loss')">- Add Credit</button>
            </div>
        </div>

        <div class="card">
            <h3 style="margin-top:0;">Search Customer Khata</h3>
            <input type="text" id="searchInput" class="search-input" placeholder="Type name to filter..." onkeyup="refreshList()">
            <div id="data-list" style="margin-top: 15px;"></div>
            <button onclick="wipeData()" style="background:none; color:var(--danger); font-size: 11px; margin-top:20px; text-decoration: underline;">Clear All Records</button>
        </div>

        <div class="dev-tag">
            <p><b>About THE AI HUB:</b> Developed by <b>Harshwardhan Singh Lodhi</b>, a student at <b>IIT Patna</b>. This application is designed to help local businesses transition from manual paper registers to a secure digital ledger system.</p>
        </div>
    </div>
</div>

<script>
    // Authentication Check
    window.onload = () => {
        const activeUser = localStorage.getItem("hub_session_user");
        if(activeUser) initApp(activeUser);
    };

    function handleLogin() {
        const name = document.getElementById("authName").value;
        if(name.trim()) { 
            localStorage.setItem("hub_session_user", name); 
            initApp(name); 
        }
    }

    function initApp(name) {
        document.getElementById("login-screen").style.display="none";
        document.getElementById("main-dashboard").style.display="block";
        document.getElementById("user-display").innerText = name;
        refreshList();
    }

    function recordEntry(type) {
        const cName = document.getElementById("customer").value;
        const amt = document.getElementById("valAmount").value;
        if(!cName || !amt) return alert("Please fill all fields!");

        const db = JSON.parse(localStorage.getItem("hub_ledger")) || [];
        db.push({ 
            owner: cName.toLowerCase(), 
            amount: parseFloat(amt), 
            category: type, 
            timestamp: new Date().toLocaleDateString() 
        });
        localStorage.setItem("hub_ledger", JSON.stringify(db));
        
        document.getElementById("customer").value = "";
        document.getElementById("valAmount").value = "";
        refreshList();
    }

    function refreshList() {
        const db = JSON.parse(localStorage.getItem("hub_ledger")) || [];
        const filter = document.getElementById("searchInput").value.toLowerCase();
        const listDiv = document.getElementById("data-list");
        let pTotal = 0, lTotal = 0;
        
        listDiv.innerHTML = "";
        db.forEach(item => {
            if(item.category === 'profit') pTotal += item.amount; else lTotal += item.amount;
            
            if(item.owner.includes(filter)) {
                listDiv.innerHTML += `
                <div class="record-row">
                    <span><b style="text-transform: capitalize;">${item.owner}</b><br><small style="color:#64748b;">${item.timestamp}</small></span>
                    <b style="color:${item.category === 'profit' ? 'var(--success)' : 'var(--danger)'}">
                        ${item.category === 'profit' ? '+' : '-'} â‚¹${item.amount}
                    </b>
                </div>`;
            }
        });
        document.getElementById("sumProfit").innerText = "â‚¹" + pTotal;
        document.getElementById("sumLoss").innerText = "â‚¹" + lTotal;
    }

    function wipeData() {
        if(confirm("Are you sure you want to delete all data permanently?")) { 
            localStorage.removeItem("hub_ledger"); 
            refreshList(); 
        }
    }
</script>

</body>
</html>
