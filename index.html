<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE AI HUB | Karan's Ledger</title>
    <style>
        :root { --primary: #6366f1; --bg: #030712; --card: #111827; --text: #f3f4f6; --green: #10b981; --red: #ef4444; }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); padding: 15px; display: flex; flex-direction: column; align-items: center; }
        .container { width: 100%; max-width: 500px; }
        .card { background: var(--card); padding: 20px; border-radius: 20px; border: 1px solid #374151; margin-bottom: 20px; }
        h2 { color: var(--primary); margin-top: 0; }
        input, textarea, select { width: 100%; padding: 12px; margin: 8px 0; border-radius: 10px; border: 1px solid #374151; background: #1f2937; color: white; box-sizing: border-box; }
        .btn { width: 100%; padding: 12px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; background: var(--primary); color: white; margin-top: 10px; }
        .summary { display: flex; justify-content: space-between; gap: 10px; }
        .stat { flex: 1; padding: 15px; border-radius: 15px; text-align: center; font-weight: bold; }
        .item-row { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #1f2937; font-size: 14px; }
        .badge { padding: 2px 8px; border-radius: 5px; font-size: 12px; }
    </style>
</head>
<body>

<div class="container">
    <div style="text-align: center; margin-bottom: 20px;">
        <h1 style="margin:0; color:var(--primary);">THE AI HUB</h1>
        <p style="margin:5px 0; color:gray;">Founder: Harshwardhan (Karan) - IIT Patna</p>
    </div>

    <div class="summary">
        <div class="stat" style="background: rgba(16, 185, 129, 0.1); color: var(--green);">Nagad (Paid)<br><span id="totalPaid">₹0</span></div>
        <div class="stat" style="background: rgba(239, 68, 68, 0.1); color: var(--red);">Udhari (Pending)<br><span id="totalUdhari">₹0</span></div>
    </div>

    <div class="card">
        <h2>Nayi Entry</h2>
        <input type="text" id="cName" placeholder="Customer Ka Naam">
        <textarea id="itemsList" rows="3" placeholder="Saman ki list (Ek line mein ek item)&#10;Jaise:&#10;Tamatar 20&#10;Aalu 40"></textarea>
        <p style="font-size: 12px; color: gray;">*Tip: Item ke baad space dekar rate likhein</p>
        <select id="pStatus">
            <option value="Paid">Paise Mil Gaye (Paid)</option>
            <option value="Udhari">Udhari Hai (Pending)</option>
        </select>
        <button class="btn" onclick="addEntry()">Bill Banayein & Save Karein</button>
    </div>

    <div id="history"></div>
</div>

<script>
    let db = JSON.parse(localStorage.getItem('karan_ledger')) || [];

    function addEntry() {
        let name = document.getElementById('cName').value;
        let listText = document.getElementById('itemsList').value;
        let status = document.getElementById('pStatus').value;

        if(!name || !listText) return alert("Pehle naam aur saman bharo!");

        // Calculation Logic
        let lines = listText.split('\n');
        let total = 0;
        lines.forEach(line => {
            let parts = line.trim().split(' ');
            let price = parseFloat(parts[parts.length - 1]);
            if(!isNaN(price)) total += price;
        });

        db.push({
            id: Date.now(),
            name: name,
            list: listText,
            total: total,
            status: status,
            date: new Date().toLocaleString()
        });

        localStorage.setItem('karan_ledger', JSON.stringify(db));
        location.reload(); 
    }

    function render() {
        let historyDiv = document.getElementById('history');
        let tP = 0, tU = 0;

        db.reverse().forEach(entry => {
            if(entry.status === 'Paid') tP += entry.total;
            else tU += entry.total;

            let waMsg = `*THE AI HUB - BILL*%0A*Customer:* ${entry.name}%0A*Saman:*%0A${entry.list}%0A---%0A*Total: ₹${entry.total}*%0A*Status:* ${entry.status}%0A_By: Karan (IIT Patna)_`;

            historyDiv.innerHTML += `
                <div class="card">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <b>${entry.name}</b>
                        <span class="badge" style="background:${entry.status === 'Paid' ? 'var(--green)' : 'var(--red)'}">${entry.status}</span>
                    </div>
                    <pre style="font-size:12px; color:gray; margin:10px 0;">${entry.list}</pre>
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <b style="font-size:18px;">Total: ₹${entry.total}</b>
                        <a href="https://wa.me/?text=${waMsg}" target="_blank" style="color:var(--primary); text-decoration:none; font-weight:bold;">Share Bill</a>
                    </div>
                    <small style="color:gray; display:block; margin-top:10px;">${entry.date}</small>
                </div>
            `;
        });

        document.getElementById('totalPaid').innerText = "₹" + tP;
        document.getElementById('totalUdhari').innerText = "₹" + tU;
    }

    render();
</script>
</body>
</html>
